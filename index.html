<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>pong</title>
</head>

<body style="background: black">

    <div align="center">
        <canvas id='canvas' width="350" height="350" align="center"></canvas>
    </div>

    <script>
        let canvas = document.getElementById('canvas')
        let canvasContext = canvas.getContext('2d')
        let ballX = canvas.width / 2
        let ballY = canvas.height / 2
        let ballVelocityX = 10
        let ballVelocityY = 0.75*ballVelocityX
        let paddleWidth = 5
        let paddleHeight = paddleWidth * 10
        let playerPaddleY = canvas.height / 2
        let aiPaddleY = playerPaddleY
        let playerScore = 0
        let aiScore = playerScore
        let winningScore = 10
        let pause = 1

        window.onload = function () {
            setInterval(function () {
                movement()
                drawView()
            }, 50)
            if (pause = 1) {
                canvas.addEventListener('mousedown', function (event) {
                    pause = 0
                })
            }

            canvas.addEventListener('touchmove', function (event) {
                mouseFix()
            })

            canvas.addEventListener('mousemove', function (event) {
                mouseFix()
            })
        }

        function mouseFix() {
            let mousePlace = mouse(event)
            paddleX1 = mousePlace.x
            playerPaddleY = mousePlace.y - paddleHeight / 2
        }

        function mouse(event) {
            let rect = canvas.getBoundingClientRect()
            let root = document.documentElement
            let mouseX = event.clientX - rect.left - root.scrollLeft
            let mouseY = event.clientY - rect.top - root.scrollTop
            return {
                x: mouseX,
                y: mouseY
            }
        }

        function restart() {
            if (playerScore == winningScore || aiScore == winningScore) {
                pause = 1
            }
            ballVelocityX = -ballVelocityX
            ballX = canvas.width / 2
            ballY = canvas.height / 2
        }

        function ai() {
            if (aiPaddleY < ballY) {
                aiPaddleY += 15
            } else if (aiPaddleY > ballY) {
                aiPaddleY -= 14
            }
        }

        function movement() {
            ai()
            ballX += ballVelocityX
            ballY += ballVelocityY
            if (ballX < paddleHeight && pause == 0) {
                if (ballY > playerPaddleY && ballY < playerPaddleY + paddleHeight) {
                    ballVelocityX = -ballVelocityX
                }
                if (ballX < 0) {
                    aiScore++
                    restart()
                }
            }
            if (ballX > canvas.width - paddleHeight && pause == 0) {
                if (ballY > aiPaddleY && ballY < aiPaddleY + paddleHeight) {
                    ballVelocityX = -ballVelocityX
                }
                if (ballX > canvas.width) {
                    playerScore++
                    restart()
                }
            }
            if (ballX < 0 || ballX > canvas.width && pause == 1) {
                ballVelocityX = -ballVelocityX
            }
            if (ballY < 0 || ballY > canvas.height) {
                ballVelocityY = -ballVelocityY
            }
        }

        function drawView() {
            colorRect(0, 0, canvas.width, canvas.height, 'red')
            if (pause == 0) {
                colorRect(canvas.width / 2, 0, 1, canvas.height, 'white')
                colorRect(25, playerPaddleY, paddleWidth, paddleHeight, 'white')
                colorRect(canvas.width - 25, aiPaddleY, paddleWidth, paddleHeight, 'white')
                canvasContext.beginPath()
                canvasContext.arc(ballX, ballY, 10, 0, 2 * Math.PI)
                canvasContext.fill()
                canvasContext.font = "20px Courier New"
                canvasContext.fillText('Score: ' + playerScore, canvas.width / 2 - 150, 100)
                canvasContext.fillText('Score: ' + aiScore, canvas.width / 2 + 50, 100)
            } else {
                playerScore = aiScore = 0
                canvasContext.fillStyle = 'yellow'
                canvasContext.font = "30px Courier New"
                canvasContext.beginPath()
                canvasContext.arc(ballX, ballY, 50, 0, 2 * Math.PI)
                canvasContext.fill()
                canvasContext.fillText('AL presents', canvas.width / 2 - 100, canvas.height / 2)
                canvasContext.fillText('Pong', canvas.width / 2 - 40, 100)
                canvasContext.font = "15px Courier New"
                canvasContext.fillText('*Tap to play*', canvas.width / 2 - 60, 300)
            }
        }

        function colorRect(cX, cY, cWidth, cHeight, cColor) {
            canvasContext.fillStyle = cColor
            canvasContext.fillRect(cX, cY, cWidth, cHeight)
        }
    </script>

</body>

</html>